<!doctype html>
<html>

<head>
    <script src="./assets/js/color-modes.js"></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Hugo 0.122.0">
    <title>Títulos</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.3/js/bootstrap.bundle.min.js"
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="canonical" href="https://getbootstrap.com/docs/5.3/examples/navbars/">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3">
    <link href="./assets/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="./css/navbars.css" rel="stylesheet">
    <script src="./assets/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/js/header.js"></script>
</head>

<body>

    <div id="header"></div> <!-- Div where the header will be inserted -->
    <div class="container mt-4">

        <h1 class="mt-4">Títulos:</h1>
        <div id="titulosContainer"> </div>
    </div>

    <script>
        $(document).ready(function () {
            fetch('https://gerenciador-80123adaa7f2.herokuapp.com/api/titulos')
                .then(response => response.json())
                .then(data => {
                    const titulosContainer = document.getElementById('titulosContainer');
                    titulosContainer.innerHTML = ''; // Limpa o conteúdo atual

                    // Agrupa os títulos por campeonato
                    const campeonatos = data.reduce((acc, titulo) => {
                        if (!acc[titulo.campeonato]) {
                            acc[titulo.campeonato] = [];
                        }
                        acc[titulo.campeonato].push(titulo);
                        return acc;
                    }, {});

                    // Cria a estrutura para cada campeonato
                    Object.keys(campeonatos).forEach(campeonato => {
                        const titulos = campeonatos[campeonato];

                        // Ordena os títulos por ano decrescente dentro de cada campeonato
                        titulos.sort((a, b) => b.ano - a.ano);

                        // Cria o título do campeonato
                        const tituloCampeonato = document.createElement('h2');
                        tituloCampeonato.innerText = campeonato;
                        titulosContainer.appendChild(tituloCampeonato);

                        // Cria a tabela para o campeonato
                        const tabela = document.createElement('table');
                        tabela.className = 'table';
                        tabela.innerHTML = `
                            <thead>
                                <tr>
                                    <th scope="col">Ano</th>
                                    <th scope="col">Usuário</th>
                                    <th scope="col">Equipe</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${titulos.map(titulo => `
                                    <tr>
                                        <td>${titulo.ano}</td>
                                        <td>${titulo.usuario}</td>
                                        <td>${titulo.equipe}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        `;
                        titulosContainer.appendChild(tabela);
                    });
                })
                .catch(error => console.error('Erro ao carregar títulos:', error));
        });
    </script>
</body>

</html>